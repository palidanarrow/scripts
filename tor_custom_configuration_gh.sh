#!/bin/bash

#-----------------------------------
#
#	          J.
#
#-----------------------------------
red=$(tput setaf 1)
default=$(tput sgr0)
yellow=$(tput setaf 3)
bold=$(tput bold)

sudo apt-get install curl >/dev/null 2>&1

printf   "\n\n\n\nInstallation & Configuration Script - Tor Proxychains Privoxy\n"
printf "
 ____       _ _     _       _   _                              \n\
|  _ \ __ _| (_) __| | __ _| \ | | __ _ _ __ _ __ _____      __\n\
| |_) / _' | | |/ _  |/ _' |  \| |/ _' | '__| '__/ _ \ \ /\ / /\n\
|  __/ (_| | | | (_| | (_| | |\  | (_| | |  | | | (_) \ V  V /\n\
|_|   \__,_|_|_|\__,_|\__,_|_| \_|\__,_|_|  |_|  \___/ \_/\_/ \n"

#----------------------------------
# Tor installation
#----------------------------------
printf   "\n\n[+] Installing Tor...\n\n"

apt-get install tor
printf   "\n[+] Tor installed"
sudo service tor start 
sudo service tor status >/dev/null 2>&1
if [[ $? != "0" ]]
then
    printf "[-] Tor is not active...you are NOT protected."
    exit
else
    printf   "\n[+] Tor is active\n" 
fi

#-----------------------------------
# Proxychains installation & config
#-----------------------------------
printf   "\n[+] Installing proxychains..."
f_proxychains="/etc/proxychains.conf"

apt-get install proxychains
printf   "\n[+] Proxychains installed"

if [[ $? != 0 ]] 
then
    printf "[-] Proxychains couldn't be installed"
    exit
else
    cp  $f_proxychains $f_proxychains.bak
    sed -i '/#socks4 127.0.0.1 9050/a socks5 127.0.0.1 9050' $f_proxychains
    sed -i "/dynamic_chain/ s/# *//" $f_proxychains  #uncomment
    sed -i '/strict_chain/s/^/#/g' $f_proxychains   #comment
    sed -i "/quiet_mode/ s/# *//" $f_proxychains
    printf   "\n[+] Proxychains configured"
fi

#------------------------------------
# Privoxy installation & configuration
#------------------------------------
printf   "\n\n[+] Installing privoxy...\n"
f_privoxy="/etc/privoxy/config"

apt-get install privoxy
cp  $f_privoxy $f_privoxy.bak
sed -i "/forward-socks5\t\t127.0.0.1:9050/ s/# *//" $f_privoxy
printf  "\n[+] Privoxy installed and ready\n\n\n"


#--------------------------------------
# Terminal Browsers
#--------------------------------------
read -p "Do you want to install lynx (classic terminal browser)? [S/n]" response

if [[ $response =~ ^(S|s|si|Si)$ ]]
then
    printf   "\n[+] Installing lynx..."
    apt-get install lynx
else
    printf   "\n[-] You should've n00b...\n\n"	
fi

read -p "Do you want to install w3m (new terminal browser)? [S/n]" response

if [[ $response =~ ^(S|s|si|Si)$ ]] 
then
    printf   "\n[+] Installing lynx...\n"
    apt-get install lynx
else
    printf   "\n[-] You should've n00b...\n\n\n"	
fi

#--------------------------------------
# Enjoy your privacy
#--------------------------------------


printf "\n\n\n:~:,,::::::::::~========++++++++++???????????+=~~:,,,,,:,,,,,,,,,:~+????IIIIIIII\n\
:::,:::~~=:::~=======+=++++++++++?????????????+=~:,,,,,,,,,,,,,,,:~+???IIIIIIIII\n\
::::~~=~~:~~~======+=++++++++++++????????????I?+~=+:,,:,,,,,,,,::::+???IIIIIIIII\n\
,:~~=~~:::~==+=+++++++++++++++?????????????IIIII++=~~~~::,,,,,,,:::=??IIIIIIIIII\n\
,:~=~~,,~~=++++++++++++++++++++???????????IIIIIII?=~:~~::::::::::::+??IIIIIIIIII\n\
~:~~:+::==+++++++++++++++++++++????????????IIIIIII?~~~~~:::::::::::+?IIIIIIIIIII\n\
I=:~~~:~=++?++?++++++++?+++++++????????????IIIIIIII?=~=~~::,:,:::::??IIIIIIIIIII\n\
II~~~:~=+++????++++++++++++++++???????????IIIIIIIIII?=~=~::::::::::+?IIIIIIIIIII\n\
II?~~~~++?+???+?++++++++++++++++?????????IIIIIIIIII?II=~~~~:::::::~+?IIIIIIIIIII\n\
III~,~~+??+???++?++++++++++++??++?++++??????IIIIIIIIII?~~~~:~~~::::+?IIIIIIIIII7\n\
I77:~~~+????+?++++++++++?++++?+++=~~:~~~~++++???+IIIIII+~~:~~:~~::~=IIIIIIIIIII7\n\
777:::~+????+??+++++?+???+?++++=~~~~~+++++~..,.II=,~====~::~::::~III?IIIIIIIIII7\n\
777~=:~=?????????++++??????++++======,:=+==++??I...,,,..,:::~:.??I+=+?IIIIIIII77\n\
777I~::=?????++==~==+?????++++++=::::~~==++=,===.=++++???:::~=???II?+=IIIIIIII77\n\
7777?~:~???+=~~~:~===++????+++:=~~:~:,..:=~::~~=?+????IIII~~~??I+?II?==?IIIIII77\n\
77777+~~?+====++===~~==+???++?+=~::,+,,,~?~+++++????IIIIII+~II?I??III?=+IIIIII77\n\
777777?=++?+++=:~::,,,:~+=...?+=~~::~~===++++++?=??IIIIIIII=?I?I++++?I=?IIIII777\n\
7777777?~==?+=:::,.,~::.:++???++++==~~~==+++++???IIIIIIIIIIIIIII+=~~~++IIIIII777\n\
77777~+++=+=~=~I=,,::~..:++??I??I+++++====++++????IIIIIIIIIIIIII?+=~??+IIIIII777\n\
777I:~:::::=++++===~~~~=+?++?III???+++++++++?????IIIIIIIIIIIIIII==?II+?IIII77777\n\
777?,+:~++=+?++++=======????IIIII???+++++++?????I?IIIIIIIIIIIIII???????IIIII7777\n\
777777++++=~?+++++++=+++??+??IIIII??++++++???????IIIIIIIIIIIIIII?+?+??IIIII77777\n\
777777++++==??++=+=++++??+???III????+++++??????IIIIIIIIIIIIIIII+?I???IIIIII77777\n\
7777777777?II???+?+++++??????II??+??=+?????????IIIIIIIII+IIIII??IIIIIIIIII777777\n\
77777777777?I???????++++???++??++??+???+??????IIIIIIIIIIIIIIII??IIIIIIII7I777777\n\
777777777777II??????+?++++?+++?++++++????????I??IIIIIIIIIIIII??IIIIIIIII77777777\n\
777777777777?III????+++++++=+++====+=++++++++II?IIIIIIIIIIIIIIIIIIIIIIII77777777\n\
7777777777777III?????++++==+=~===~===~===~=~?+?IIIIIIIIIIIIII?I?IIIIIIII7II77777\n\
7777777777777IIII????+?+=====+===????+?+?+=+=++?II?IIIIIIIII?+IIIIIIIII777777777\n\
77777777777777III????++=?+++??++====~=~:::~=+++?+I???IIIIIIIIIIIIIIIIII777777777\n\
777777777777777III???+=++?+=~~=I~:~=++++???+==+???I??IIIIII?+IIIIIIIII7777777777\n\
777777777777777III??++=++=~:~~=====+?????????+?+????+IIIII?I?IIIIIIIIII7II777777\n\
7777777777777777?????++=+==+++++?????????????++????I?III?????III?IIIIII777777777\n\
77777777777777777?I???=+???????+++=+?????????+????II?I????+?IIIIIIIII77777777777\n\
777777777777777777I+??????????+++~=+?????????+=+????????????IIIIIIIIIII777777777\n\
777777777777777777??????+???????++=+++????+?+?+++??+???+=??IIIIII+.....,,:I77777\n\
7777777777777777777????++??????+==++++????????+?+++~?++??+?IIIIIII........:+7777\n\
77777777777777777777????=????+++++++++++?+++++?=+=~+=+?????IIIIIII.........=+777\n\
777777777777777777777I?++??++++=++?+?++++?++++?=+=?==+??????I?IIII?.......,++=77\n\
77777777777777777777777++++=++++=+++==+++=+==~:~~~++++?????IIIIIII?~......=++++7\n\
777777777777777777777777++======+=====+===:~~~?~===+????????IIIII??=~,....~+++++\n\
7777777777777777777777777?+:=~~====~~=+=~~~::~~=++???????IIIIIII??+=~~,,.~=+=+++\n\
7777777777777777777777777?I??:~=~~=~:==,::~~~===+?????+?I?IIII???+=~~~:,,~++++++\n\
7777777777777777777777777I?II???+:~::~:~~~~~=+=????????I????????+=~~~~:,~==+++==\n\
77777777777777777777777777??I????????++?++++????????????????+:++==~~~:::~=+++=++\n\
77777777777777777777777777I?II??????????????????????????????+++==~~~~::~==+++++=\n\
77777777777777777777777777=??II???????????????????????????++++====~~~::~~+=++++=\n\
777777777777777777777777I,,??II??I?????????????????????++++++=====~~::~~=+++++++\n\
77777777777777777777777:,,,~?????????????????????????++++++=======~~::~~++=+++=+\n\
7777777777777777777777:,,,,.?????????????????????++?+++++=+======~~~~~~=++=+++++\n\
777777777777777777777:,,,,,.,??I??????????????????++++++=========~~~~~==+++++===\n\
7777777777777777777?:,,,,,...+?????????????????++++++++++=========~=:~==+++=+=+=\n\
777777777777777777=:,,,,,....~+????????????????++++++++++++=========,...,=+~+++=\n\
77777777777777777:::,,,,,.....+++?????????????+++++++++++=+======~=~.......:=+~=\n\
777777777777777+~::::,,,,.....=+++???????????+++++++++++++++++==:~:~...........:\n\
7777777777777I~::::::,,,,.....,:=+++?????????+++?+++++++++++++==~:~:,..........,\n\
777777777777~~::::::::,,.......,,:=+?+??????????+++++??++++++++~=~::,.........,,\n\
7777777777::~~::::::::,,......,,,,,:+++????????????????++++++++~~:::,,........,,\n\
77777777~::~~,::::::::,,......,,,,,,,:++?????????????+?+?+++++=~:::~::,......,::\n\
777777::::~,.:~~:~~:::,,......,,,,,,,,:=+????????????????++++++=~~~~~::,...,,:::\n\
			     Can you hear me now?"



printf "\n\n\n\n"
old_ip=$(curl -s www.icanhazip.com )
old_geo=$(curl -s http://whatismycountry.com/ |   sed -n 's|.*> *\(.*\)</h3>|\1|p')
old_dns=$(curl -s dnsleak.com | grep "You are connecting from IPv4 address*")
tor_ip=$(proxychains  curl -s  www.icanhazip.com )
tor_geo=$(proxychains curl -s http://whatismycountry.com/ | sed -n 's|.*> *\(.*\)</h3>|\1|p')
tor_dns=$(proxychains curl -s dnsleak.com | grep "You are connecting from IPv4 address*")

printf "\n\n\n"
printf " =============================================================================\n \
                             Enjoy your privacy.                                  \n \
=============================================================================\n"

red=$(tput setaf 1)
default=$(tput sgr0)
printf '\nYour old ip was: %s - %s' "$old_ip" "$old_geo"
printf '\nDNSleak was: %s' "${old_dns:44:(-5)}"
printf '\n\nYour new ip is: ' 
printf '%s' "$tor_ip" | tail -n 1
printf ' - %s' "$tor_geo"
printf '\nDNSleak is: %s' "${tor_dns:44:(-5)}"
printf '\n\n%s' "${yellow}[!]${red} Use always the command ${bold} proxychains ${default}${red} to redirect all traffic through Tor.${default}"
printf  "\n\n"
                                                               








